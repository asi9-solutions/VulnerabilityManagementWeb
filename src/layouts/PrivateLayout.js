import React from 'react';
import Header from '../pages/Main/Header';
import SideBar from '../components/SideBar';
import cx from 'classnames';
import { setMobileNavVisibility } from '../reducers/Layout';
import { withRouter } from 'react-router-dom';
import { connect } from 'react-redux';

const PrivateLayout = ({
  mobileNavVisibility,
  hideMobileMenu,
  history,
  component: Component,
  children,
  ...rest
}) => {
  history.listen(() => {
    if (mobileNavVisibility === true) {
      hideMobileMenu();
    }
  });
  return (
    <div className={cx({ 'nav-open': mobileNavVisibility === true })}>
      <div className="wrapper">
        <div className="close-layer" onClick={hideMobileMenu} />
        <SideBar />
        <div>
          <Header
            {...rest}
            render={matchProps => <Component {...matchProps} />}
          />
        </div>
        <div className="main-panel">
          {children}
          <div className="bottom-spacing" />
        </div>
      </div>
    </div>
  );
};

const mapStateToProp = state => ({
  mobileNavVisibility: state.Layout.mobileNavVisibility,
});

const mapDispatchToProps = (dispatch, ownProps) => ({
  hideMobileMenu: () => dispatch(setMobileNavVisibility(false)),
});

export default withRouter(
  connect(
    mapStateToProp,
    mapDispatchToProps
  )(PrivateLayout)
);
//export default PrivateLayout;
